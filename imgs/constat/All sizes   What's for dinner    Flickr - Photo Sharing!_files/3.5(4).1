/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("history-html5",function(g){var b=g.HistoryBase,c=g.Lang,f=g.config.win,d=g.config.useHistoryHTML5,h="popstate",e=b.SRC_REPLACE;function a(){a.superclass.constructor.apply(this,arguments);}g.extend(a,b,{_init:function(i){var j=f.history.state;i||(i={});if(i.initialState&&c.type(i.initialState)==="object"&&c.type(j)==="object"){this._initialState=g.merge(i.initialState,j);}else{this._initialState=j;}g.on("popstate",this._onPopState,f,this);a.superclass._init.apply(this,arguments);},_storeState:function(k,j,i){if(k!==h){f.history[k===e?"replaceState":"pushState"](j,i.title||g.config.doc.title||"",i.url||null);}a.superclass._storeState.apply(this,arguments);},_onPopState:function(i){this._resolveChanges(h,i._event.state||null);}},{NAME:"historyhtml5",SRC_POPSTATE:h});if(!g.Node.DOM_EVENTS.popstate){g.Node.DOM_EVENTS.popstate=1;}g.HistoryHTML5=a;if(d===true||(d!==false&&b.html5)){g.History=a;}},"3.5.1",{optional:["json"],requires:["event-base","history-base","node-base"]});/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("history-hash",function(a){var c=a.HistoryBase,f=a.Lang,l=a.Array,j=a.Object,k=YUI.namespace("Env.HistoryHash"),b="hash",e,d,i,h=a.config.win,m=a.config.useHistoryHTML5;function g(){g.superclass.constructor.apply(this,arguments);}a.extend(g,c,{_init:function(n){var o=g.parseHash();n=n||{};this._initialState=n.initialState?a.merge(n.initialState,o):o;a.after("hashchange",a.bind(this._afterHashChange,this),h);g.superclass._init.apply(this,arguments);},_change:function(p,o,n){j.each(o,function(r,q){if(f.isValue(r)){o[q]=r.toString();}});return g.superclass._change.call(this,p,o,n);},_storeState:function(q,p){var o=g.decode,n=g.createHash(p);g.superclass._storeState.apply(this,arguments);if(q!==b&&o(g.getHash())!==o(n)){g[q===c.SRC_REPLACE?"replaceHash":"setHash"](n);}},_afterHashChange:function(n){this._resolveChanges(b,g.parseHash(n.newHash),{});}},{NAME:"historyHash",SRC_HASH:b,hashPrefix:"",_REGEX_HASH:/([^\?#&]+)=([^&]+)/g,createHash:function(p){var n=g.encode,o=[];j.each(p,function(r,q){if(f.isValue(r)){o.push(n(q)+"="+n(r));}});return o.join("&");},decode:function(n){return decodeURIComponent(n.replace(/\+/g," "));},encode:function(n){return encodeURIComponent(n).replace(/%20/g,"+");},getHash:(a.UA.gecko?function(){var n=a.getLocation(),p=/#(.*)$/.exec(n.href),q=p&&p[1]||"",o=g.hashPrefix;return o&&q.indexOf(o)===0?q.replace(o,""):q;}:function(){var n=a.getLocation(),p=n.hash.substring(1),o=g.hashPrefix;return o&&p.indexOf(o)===0?p.replace(o,""):p;}),getUrl:function(){return location.href;},parseHash:function(q){var n=g.decode,r,u,s,o,p={},t=g.hashPrefix,v;q=f.isValue(q)?q:g.getHash();if(t){v=q.indexOf(t);if(v===0||(v===1&&q.charAt(0)==="#")){q=q.replace(t,"");}}s=q.match(g._REGEX_HASH)||[];for(r=0,u=s.length;r<u;++r){o=s[r].split("=");p[n(o[0])]=n(o[1]);}return p;},replaceHash:function(p){var n=a.getLocation(),o=n.href.replace(/#.*$/,"");if(p.charAt(0)==="#"){p=p.substring(1);}n.replace(o+"#"+(g.hashPrefix||"")+p);},setHash:function(o){var n=a.getLocation();if(o.charAt(0)==="#"){o=o.substring(1);}n.hash=(g.hashPrefix||"")+o;}});e=k._notifiers;if(!e){e=k._notifiers=[];}a.Event.define("hashchange",{on:function(p,n,o){if(p.compareTo(h)||p.compareTo(a.config.doc.body)){e.push(o);}},detach:function(q,o,p){var n=l.indexOf(e,p);if(n!==-1){e.splice(n,1);}}});d=g.getHash();i=g.getUrl();if(c.nativeHashChange){a.Event.attach("hashchange",function(p){var n=g.getHash(),o=g.getUrl();l.each(e.concat(),function(q){q.fire({_event:p,oldHash:d,oldUrl:i,newHash:n,newUrl:o});});d=n;i=o;},h);}else{if(!k._hashPoll){k._hashPoll=a.later(50,null,function(){var o=g.getHash(),n,p;if(d!==o){p=g.getUrl();n={oldHash:d,oldUrl:i,newHash:o,newUrl:p};d=o;i=p;l.each(e.concat(),function(q){q.fire(n);});}},null,true);}}a.HistoryHash=g;if(m===false||(!a.History&&m!==true&&(!c.html5||!a.HistoryHTML5))){a.History=g;}},"3.5.1",{requires:["event-synthetic","history-base","yui-later"]});/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("history-hash-ie",function(f){if(f.UA.ie&&!f.HistoryBase.nativeHashChange){var b=f.Do,c=YUI.namespace("Env.HistoryHash"),a=f.HistoryHash,d=c._iframe,e=f.config.win;a.getIframeHash=function(){if(!d||!d.contentWindow){return"";}var g=a.hashPrefix,h=d.contentWindow.location.hash.substr(1);return g&&h.indexOf(g)===0?h.replace(g,""):h;};a._updateIframe=function(h,g){var i=d&&d.contentWindow&&d.contentWindow.document,j=i&&i.location;if(!i||!j){return;}if(g){j.replace(h.charAt(0)==="#"?h:"#"+h);}else{i.open().close();j.hash=h;}};b.before(a._updateIframe,a,"replaceHash",a,true);if(!d){f.on("domready",function(){var g=a.getHash();d=c._iframe=f.Node.getDOMNode(f.Node.create('<iframe src="javascript:0" style="display:none" height="0" width="0" tabindex="-1" title="empty"/>'));f.config.doc.documentElement.appendChild(d);a._updateIframe(g||"#");f.on("hashchange",function(h){g=h.newHash;if(a.getIframeHash()!==g){a._updateIframe(g);}},e);f.later(50,null,function(){var h=a.getIframeHash();if(h!==g){a.setHash(h);}},null,true);});}}},"3.5.1",{requires:["history-hash","node-base"]});/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("router",function(h){var c=h.HistoryHash,b=h.QueryString,f=h.Array,g=h.config.win,e=[],d="ready";function a(){a.superclass.constructor.apply(this,arguments);}h.Router=h.extend(a,h.Base,{_regexPathParam:/([:*])([\w\-]+)?/g,_regexUrlQuery:/\?([^#]*).*$/,_regexUrlOrigin:/^(?:[^\/#?:]+:\/\/|\/\/)[^\/]*/,initializer:function(j){var i=this;i._html5=i.get("html5");i._routes=[];i._url=i._getURL();i._setRoutes(j&&j.routes?j.routes:i.get("routes"));if(i._html5){i._history=new h.HistoryHTML5({force:true});h.after("history:change",i._afterHistoryChange,i);}else{h.on("hashchange",i._afterHistoryChange,g,i);}i.publish(d,{defaultFn:i._defReadyFn,fireOnce:true,preventable:false});i.once("initializedChange",function(){h.once("load",function(){setTimeout(function(){i.fire(d,{dispatched:!!i._dispatched});},20);});});},destructor:function(){if(this._html5){h.detach("history:change",this._afterHistoryChange,this);}else{h.detach("hashchange",this._afterHistoryChange,g);}},dispatch:function(){this.once(d,function(){this._ready=true;if(this._html5&&this.upgrade()){return;}else{this._dispatch(this._getPath(),this._getURL());}});return this;},getPath:function(){return this._getPath();},hasRoute:function(i){if(!this._hasSameOrigin(i)){return false;}i=this.removeQuery(this.removeRoot(i));return !!this.match(i).length;},match:function(i){return f.filter(this._routes,function(j){return i.search(j.regex)>-1;});},removeRoot:function(j){var i=this.get("root");j=j.replace(this._regexUrlOrigin,"");if(i&&j.indexOf(i)===0){j=j.substring(i.length);}return j.charAt(0)==="/"?j:"/"+j;},removeQuery:function(i){return i.replace(/\?.*$/,"");},replace:function(i){return this._queue(i,true);},route:function(j,k){var i=[];this._routes.push({callback:k,keys:i,path:j,regex:this._getRegex(j,i)});return this;},save:function(i){return this._queue(i);},upgrade:function(){if(!this._html5){return false;}var i=c.getHash();if(i&&i.charAt(0)==="/"){this.once(d,function(){this.replace(i);});return true;}return false;},_decode:function(i){return decodeURIComponent(i.replace(/\+/g," "));},_dequeue:function(){var i=this,j;if(!YUI.Env.windowLoaded){h.once("load",function(){i._dequeue();});return this;}j=e.shift();return j?j():this;},_dispatch:function(n,k,o){var j=this,i=j.match(n),m,l;j._dispatching=j._dispatched=true;if(!i||!i.length){j._dispatching=false;return j;}m=j._getRequest(n,k,o);l=j._getResponse(m);m.next=function(q){var s,r,p;if(q){h.error(q);}else{if((p=i.shift())){r=p.regex.exec(n);s=typeof p.callback==="string"?j[p.callback]:p.callback;if(r.length===p.keys.length+1){m.params=f.hash(p.keys,r.slice(1));}else{m.params=r.concat();}s.call(j,m,l,m.next);}}};m.next();j._dispatching=false;return j._dequeue();},_getHashPath:function(){return c.getHash().replace(this._regexUrlQuery,"");},_getOrigin:function(){var i=h.getLocation();return i.origin||(i.protocol+"//"+i.host);},_getPath:function(){var i=(!this._html5&&this._getHashPath())||h.getLocation().pathname;return this.removeQuery(this.removeRoot(i));},_getQuery:function(){var i=h.getLocation(),k,j;if(this._html5){return i.search.substring(1);}k=c.getHash();j=k.match(this._regexUrlQuery);return k&&j?j[1]:i.search.substring(1);},_getRegex:function(j,i){if(j instanceof RegExp){return j;}if(j==="*"){return(/.*/);}j=j.replace(this._regexPathParam,function(l,k,m){if(!m){return k==="*"?".*":l;}i.push(m);return k==="*"?"(.*?)":"([^/#?]*)";});return new RegExp("^"+j+"$");},_getRequest:function(j,i,k){return{path:j,query:this._parseQuery(this._getQuery()),url:i,src:k};},_getResponse:function(j){var i=function(){return j.next.apply(this,arguments);};i.req=j;return i;},_getRoutes:function(){return this._routes.concat();},_getURL:function(){return h.getLocation().toString();},_hasSameOrigin:function(j){var i=((j&&j.match(this._regexUrlOrigin))||[])[0];if(i&&i.indexOf("//")===0){i=h.getLocation().protocol+i;}return !i||i===this._getOrigin();},_joinURL:function(j){var i=this.get("root");j=this.removeRoot(j);if(j.charAt(0)==="/"){j=j.substring(1);}return i&&i.charAt(i.length-1)==="/"?i+j:i+"/"+j;},_parseQuery:b&&b.parse?b.parse:function(m){var n=this._decode,p=m.split("&"),l=0,k=p.length,j={},o;for(;l<k;++l){o=p[l].split("=");if(o[0]){j[n(o[0])]=n(o[1]||"");}}return j;},_queue:function(){var j=arguments,i=this;e.push(function(){if(i._html5){if(h.UA.ios&&h.UA.ios<5){i._save.apply(i,j);}else{setTimeout(function(){i._save.apply(i,j);},1);}}else{i._dispatching=true;i._save.apply(i,j);}return i;});return !this._dispatching?this._dequeue():this;},_save:function(j,k){var i=typeof j==="string";if(i&&!this._hasSameOrigin(j)){h.error("Security error: The new URL must be of the same origin as the current URL.");return this;}this._ready=true;if(this._html5){this._history[k?"replace":"add"](null,{url:i?this._joinURL(j):j});}else{i&&(j=this.removeRoot(j));if(j===c.getHash()){this._dispatch(this._getPath(),this._getURL());}else{c[k?"replaceHash":"setHash"](j);}}return this;},_setRoutes:function(i){this._routes=[];f.each(i,function(j){this.route(j.path,j.callback);},this);return this._routes.concat();},_afterHistoryChange:function(k){var i=this,m=k.src,j=i._url,l=i._getURL();i._url=l;if(m==="popstate"&&(!i._ready||j.replace(/#.*$/,"")===l.replace(/#.*$/,""))){return;}i._dispatch(i._getPath(),l,m);},_defReadyFn:function(i){this._ready=true;}},{NAME:"router",ATTRS:{html5:{valueFn:function(){return h.Router.html5;},writeOnce:"initOnly"},root:{value:""},routes:{value:[],getter:"_getRoutes",setter:"_setRoutes"}},html5:h.HistoryBase.html5&&(!h.UA.android||h.UA.android>=3)});h.Controller=h.Router;},"3.5.1",{requires:["array-extras","base-build","history"],optional:["querystring-parse"]});/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("pjax-base",function(f){var d=f.config.win,b=f.Lang,e=f.ClassNameManager.getClassName("pjax"),a="navigate";function c(){}c.prototype={_regexURL:/^((?:[^\/#?:]+:\/\/|\/\/)[^\/]*)?([^?#]*)(\?[^#]*)?(#.*)?$/,initializer:function(){this.publish(a,{defaultFn:this._defNavigateFn});if(this.get("html5")){this._pjaxBindUI();}},destructor:function(){this._pjaxEvents&&this._pjaxEvents.detach();},navigate:function(h,g){h=this._resolveURL(h);if(this._navigate(h,g)){return true;}if(!this._hasSameOrigin(h)){f.error("Security error: The new URL must be of the same origin as the current URL.");}return false;},_getRoot:function(){var h="/",i=f.getLocation().pathname,g;if(i.charAt(i.length-1)===h){return i;}g=i.split(h);g.pop();return g.join(h)+h;},_navigate:function(i,h){if(!this.hasRoute(i)){return false;}h||(h={});h.url=i;var k=this._getURL(),j,g;g=i.replace(/(#.*)$/,function(l,n,m){j=n;return l.substring(m);});if(j&&g===k.replace(/#.*$/,"")){if(!this.get("navigateOnHash")){return false;}h.hash=j;}"replace" in h||(h.replace=i===k);if(this.get("html5")||h.force){this.fire(a,h);}else{if(h.replace){d&&d.location.replace(i);}else{d&&(d.location=i);}}return true;},_normalizePath:function(p){var m="..",g="/",h,l,o,j,k,n;if(!p||p===g){return g;}j=p.split(g);n=[];for(h=0,l=j.length;h<l;++h){k=j[h];if(k===m){n.pop();}else{if(k){n.push(k);}}}o=g+n.join(g);if(o!==g&&p.charAt(p.length-1)===g){o+=g;}return o;},_pjaxBindUI:function(){if(!this._pjaxEvents){this._pjaxEvents=f.one("body").delegate("click",this._onLinkClick,this.get("linkSelector"),this);}},_resolvePath:function(g){if(!g){return this._getPath();}if(g.charAt(0)==="/"){return this._normalizePath(g);}return this._normalizePath(this._getRoot()+g);},_resolveURL:function(i){var m=i&&i.match(this._regexURL),h,l,j,k,g;if(!m){return this._getURL();}h=m[1];l=m[2];j=m[3];k=m[4];if(h){if(h.indexOf("//")===0){h=f.getLocation().protocol+h;}return h+(l||"/")+(j||"")+(k||"");}g=this._getOrigin()+this._resolvePath(l);if(l||j){return g+(j||"")+(k||"");}j=this._getQuery();return g+(j?("?"+j):"")+(k||"");},_defNavigateFn:function(g){this[g.replace?"replace":"save"](g.url);if(d&&this.get("scrollToTop")){setTimeout(function(){d.scroll(0,0);},1);}},_onLinkClick:function(h){var g;if(h.button!==1||h.ctrlKey||h.metaKey){return;}g=h.currentTarget.get("href");g&&this._navigate(g,{originEvent:h})&&h.preventDefault();}};c.ATTRS={linkSelector:{value:"a."+e,writeOnce:"initOnly"},navigateOnHash:{value:false},scrollToTop:{value:true}};f.PjaxBase=c;},"3.5.1",{requires:["classnamemanager","node-event-delegate","router"]});/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("view",function(b){function a(){a.superclass.constructor.apply(this,arguments);}b.View=b.extend(a,b.Base,{containerTemplate:"<div/>",events:{},template:"",_allowAdHocAttrs:true,initializer:function(c){c||(c={});c.containerTemplate&&(this.containerTemplate=c.containerTemplate);c.template&&(this.template=c.template);this.events=c.events?b.merge(this.events,c.events):this.events;this.after("containerChange",this._afterContainerChange);},destroy:function(c){if(c&&(c.remove||c["delete"])){this.onceAfter("destroy",function(){this._destroyContainer();});}return a.superclass.destroy.call(this);},destructor:function(){this.detachEvents();delete this._container;},attachEvents:function(g){var d=this.get("container"),i=b.Object.owns,h,e,f,c;this.detachEvents();g||(g=this.events);for(c in g){if(!i(g,c)){continue;}e=g[c];for(f in e){if(!i(e,f)){continue;}h=e[f];if(typeof h==="string"){h=this[h];}this._attachedViewEvents.push(d.delegate(f,h,c,this));}}return this;},create:function(c){return c?b.one(c):b.Node.create(this.containerTemplate);},detachEvents:function(){b.Array.each(this._attachedViewEvents,function(c){c.detach();});this._attachedViewEvents=[];return this;},remove:function(){var c=this.get("container");c&&c.remove();return this;},render:function(){return this;},_destroyContainer:function(){var c=this.get("container");c&&c.remove(true);},_getContainer:function(c){if(!this._container){if(c){this._container=c;this.attachEvents();}else{c=this._container=this.create();this._set("container",c);}}return c;},_afterContainerChange:function(){this.attachEvents(this.events);}},{NAME:"view",ATTRS:{container:{getter:"_getContainer",setter:b.one,writeOnce:true}},_NON_ATTRS_CFG:["containerTemplate","events","template"]});},"3.5.1",{requires:["base-build","node-event-delegate"]});/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("app-base",function(c){var g=c.Lang,i=c.Object,a=c.PjaxBase,d=c.Router,b=c.View,e=c.ClassNameManager.getClassName,h=c.config.win,f;f=c.Base.create("app",c.Base,[b,d,a],{views:{},initializer:function(k){k||(k={});var j={};function l(m,n){j[n]=c.merge(j[n],m);}i.each(this.views,l);i.each(k.views,l);this.views=j;this._viewInfoMap={};this.after("activeViewChange",c.bind("_afterActiveViewChange",this));if(!this.get("serverRouting")){this._pjaxBindUI();}},createView:function(m,l){var k=this.getViewInfo(m),n=(k&&k.type)||b,o,j;o=g.isString(n)?i.getValue(c,n.split(".")):n;j=new o(l);this._viewInfoMap[c.stamp(j,true)]=k;return j;},getViewInfo:function(j){if(g.isString(j)){return this.views[j];}return j&&this._viewInfoMap[c.stamp(j,true)];},render:function(){var k=this.get("container"),j=this.get("viewContainer"),l=this.get("activeView"),n=l&&l.get("container"),m=k.compareTo(j);k.addClass(f.CSS_CLASS);j.addClass(f.VIEWS_CSS_CLASS);if(l&&!j.contains(n)){j.appendChild(n);}if(!k.contains(j)&&!m){k.appendChild(j);}return this;},showView:function(j,m,l,o){var k,n;l||(l={});if(o){l.callback=o;}else{if(g.isFunction(l)){l={callback:l};}}if(g.isString(j)){k=this.getViewInfo(j);if(k&&k.preserve&&k.instance){j=k.instance;this._viewInfoMap[c.stamp(j,true)]=k;}else{j=this.createView(j,m);n=true;}}if(l.update&&!n){j.setAttrs(m);}if("render" in l){l.render&&j.render();}else{if(n){j.render();}}return this._set("activeView",j,{options:l});},_attachView:function(k,l){if(!k){return;}var m=this.getViewInfo(k),j=this.get("viewContainer");k.addTarget(this);m&&(m.instance=k);j[l?"prepend":"append"](k.get("container"));},_destroyContainer:function(){var k=this.get("container"),j=this.get("viewContainer"),l=k.compareTo(j);if(c.one("body").compareTo(k)){this.detachEvents();k&&k.removeClass(f.CSS_CLASS);if(l){k&&k.removeClass(f.VIEWS_CSS_CLASS);}else{j&&j.remove(true);}return;}j&&j.remove(true);!l&&k&&k.remove(true);},_detachView:function(j){if(!j){return;}var k=this.getViewInfo(j)||{};if(k.preserve){j.remove();}else{j.destroy({remove:true});delete this._viewInfoMap[c.stamp(j,true)];if(j===k.instance){delete k.instance;}}j.removeTarget(this);},_getViewContainer:function(j){if(!j&&!this._viewContainer){j=this._viewContainer=this.create();this._set("viewContainer",j);}return j;},_getURL:function(){var j=c.getLocation().toString();return this._html5?j:this._upgradeURL(j);},_initHtml5:function(){if(this.get("serverRouting")===false){return false;}else{return d.html5;}},_isChildView:function(j,m){var l=this.getViewInfo(j),k=this.getViewInfo(m);if(l&&k){return this.getViewInfo(l.parent)===k;}return false;},_isParentView:function(j,m){var k=this.getViewInfo(j),l=this.getViewInfo(m);if(k&&l){return this.getViewInfo(l.parent)===k;}return false;},_navigate:function(k,j){k=this._upgradeURL(k);j||(j={});if(!this.get("serverRouting")){"force" in j||(j.force=true);}return a.prototype._navigate.call(this,k,j);},_save:function(j,k){if(this.get("serverRouting")&&!this.get("html5")){if(!this._hasSameOrigin(j)){c.error("Security error: The new URL must be of the same origin as the current URL.");return this;}j=this._joinURL(j||"");if(k){h&&h.location.replace(j);}else{h&&(h.location=j);}return this;}return d.prototype._save.apply(this,arguments);},_uiSetActiveView:function(p,n,m){m||(m={});var o=m.callback,j=this._isChildView(p,n),l=!j&&this._isParentView(p,n),k=!!m.prepend||l;if(p===n){return o&&o.call(this,p);}this._attachView(p,k);this._detachView(n);o&&o.call(this,p);},_upgradeURL:function(k){if(!this._hasSameOrigin(k)){return k;}var l=(k.match(/#(.*)$/)||[])[1]||"",j=c.HistoryHash.hashPrefix;if(j&&l.indexOf(j)===0){l=l.replace(j,"");}if(l&&l.charAt(0)==="/"){k=this._resolveURL(this._joinURL(l));}return k;},_afterActiveViewChange:function(j){this._uiSetActiveView(j.newVal,j.prevVal,j.options);}},{ATTRS:{activeView:{value:null,readOnly:true},container:{valueFn:function(){return c.one("body");}},html5:{valueFn:"_initHtml5"},linkSelector:{value:"a"},serverRouting:{value:undefined,writeOnce:"initOnly"},viewContainer:{getter:"_getViewContainer",setter:c.one,writeOnce:true}},CSS_CLASS:e("app"),VIEWS_CSS_CLASS:e("app","views"),_NON_ATTRS_CFG:["views"]});c.namespace("App").Base=f;c.App=c.mix(c.Base.create("app",c.App.Base,[]),c.App,true);},"3.5.1",{requires:["classnamemanager","pjax-base","router","view"]});(function(){var a="flickr-app";YUI.add(a,function(g){var f;function e(){if(!f){f=new g.App({serverRouting:true,linkSelector:false,scrollToTop:false});f.upgradeClick=d;f.saveIfRoutable=c;f.replaceIfRoutable=b;g.FlickrApp=f;if(g.config.flickr.user.admin_user==="hartsell"){F.FlickrApp=f}}}function c(h){var i;i=f.removeRoot(h);if(f.hasRoute(i)){f.save(i);return true}return false}function b(h){var i;i=f.removeRoot(h);if(f.hasRoute(i)){f.replace(i);return true}return false}function d(k){var i,h,j;if(k.altKey||k.ctrlKey||k.metaKey||k.shiftKey){return}i=k.target.ancestor("a",true);h=i&&i.getAttribute("href");if(h){j=f.removeRoot(h);if(f.hasRoute(j)){k.preventDefault();f.save(j);return true}}return false}g.FlickrApp={init:e}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());YUI.add("flickr-tooltips",function(a){var q=null,g=null,b=0,k=null,c=null,n=null;function h(){q=document.createElement("div");g=document.createElement("div");q.style.display="none";q.style.zIndex="200000";document.body.appendChild(q);q.appendChild(g)}function m(s,u,v,r,z){var t,B,C,A;s=a.one(s);z=z||"ToolTip";if(!q){h()}if(s.getStyle("visibility")==="hidden"){return}q.className=z;if(b){if(k===s._node){d();return}d()}r=(r===undefined)?"":r;v+=r.length;n=document.getElementById(u);g.innerHTML=n.innerHTML+r;g.style.width="auto";q.style.display="block";q.style.visibility="hidden";if(z!=="ToolTipSmall"){w=150;if(v>200){w=300}else{if(v>100){w=200}}g.style.width=w+"px"}t=q.offsetWidth;C=s.getX();A=s.getY();if(z==="ToolTipSmall"){C-=Math.round((t-s.get("offsetWidth"))/2)-5;if(s._node.tip_placement==="below"){A+=s.get("offsetHeight")+10}else{A-=22}}else{A+=20}B=f()-40;if(C+t>B){C=B-t}C=Math.max(10,C);q.style.left=C+"px";q.style.top=A+"px";b=1;q.style.display="block";q.style.visibility="visible";k=s._node;document.onmousedown=l}function l(s){var r=e(s);if(r===k||(o(r)&&j(r))){document.onmousedown=function(){}}else{d()}}function d(r){if(r){if(k!==r){return}}document.onmousedown=function(){};if(!q){return false}b=0;q.style.display="none";k="null";return false}function j(r){var s=r;while(s){if(s===q){return 1}s=s.parentNode}return 0}function o(r){var s=r;while(s){if(s.href){return 1}s=s.parentNode}return 0}function i(){if(window.innerHeight){return window.innerHeight}else{if(document.documentElement.clientHeight){return document.documentElement.clientHeight}else{if(document.body.clientHeight){return document.body.clientHeight}}}}function f(){if(window.innerWidth){return window.innerWidth}else{if(document.documentElement.clientWidth){return document.documentElement.clientWidth}else{if(document.body.clientWidth){return document.body.clientWidth}}}}function e(r){if(r&&r.target){return r.target}if(r&&r.srcElement){return r.srcElement}if(window.event){return window.event.srcElement}return null}function p(){window.show_tooltip=m}a.tooltips={init:p}},"0.0.1",{requires:["node","event","event-delegate"]});YUI.add("cache-simple",function(a){CacheSimple=function(){};CacheSimple.prototype={cache:{},add:function(b,c,d){this.cache[b]={response:c,payload:d}},retrieve:function(b){return this.cache[b]},clear:function(){this.cache={}}};a.CacheSimple=CacheSimple},"0.0.1");YUI.add("node-visibility",function(b){var o,m,f,k,n,a,p,q,e=window,r=window.document;m={resize:[],scroll:[]};function j(s){b.Array.each(m.scroll,function(t){t(s)})}function c(s){b.Array.each(m.resize,function(t){t(s)})}f={register:function(t,u){var s=m[t].push(u);return{detach:function(){m[t][s]=function(){}}}}};b.on("scroll",b.betterThrottle(j,50));b.on("resize",b.betterThrottle(c,50));function i(){var s=i.region;if(!s){s={};s.height=b.DOM.winHeight();s.width=b.DOM.winWidth();s.top=Math.max(r.body.scrollTop||0,r.documentElement.scrollTop||0,e.pageYOffset||0);s.left=Math.max(r.body.scrollLeft||0,r.documentElement.scrollLeft||0,e.pageXOffset||0);s.right=s.left+s.width;s.bottom=s.top+s.height;s[0]=s.top;s[1]=s.left;i.region=s}return s}function d(){i.region=undefined}f.register("resize",d);f.register("scroll",d);function l(t,s){var u={};if(b.Lang.isNumber(s[0])){u.left=t.left-s[0];u.right=t.right+s[0];u.width=t.width+s[0]*2;if(u.width<1){u.width=1;u.left=Math.floor((t.right+t.left)/2);u.right=u.left+1}u[0]=u.top}if(b.Lang.isNumber(s[1])){u.top=t.top-s[1];u.bottom=t.bottom+s[1];u.height=t.height+s[1]*2;if(u.height<1){u.height=1;u.top=Math.floor((t.bottom+t.top)/2);u.bottom=u.top+1}u[1]=u.left}return u}k=function(u,t){var s,v;for(s=u.ancestor();s;s=s.ancestor()){v=s.getStyle("overflow");if(v!==""&&v!=="visible"){t=t||u.get("region");if(!u.inRegion(s,false,t)){return true}}}return false};function g(t){var s,u;if(!g.cache){g.cache=new b.CacheSimple()}s=g.cache;if(b.Lang.isString(t)){u=s.retrieve(t);if(u&&u.response&&(new Date()).getTime()<u.payload.expires){return u.response}else{return null}}else{return s}}function h(s,u){var t=500;if(!b.Lang.isString(s)){return false}g().add(s,u,{expires:(new Date()).getTime()+t});return true}n=function(v,s){var t,y,w,u,x;t=true;s=s?p(s):[0,0];w=v.toString();x=g(w);u=x||{};if(t){if(!b.Lang.isString(u.display)){u.display=v.getStyle("display")}if(!b.Lang.isNumber(u.offsetHeight)){u.offsetHeight=v.get("offsetHeight")}if(!b.Lang.isNumber(u.offsetWidth)){u.offsetWidth=v.get("offsetWidth")}if(u.display==="block"&&(u.offsetHeight===0||u.offsetWidth===0)){t=false}}if(t){y=i();if(!u.region){u.region=v.get("region")}if(!v.inRegion(l(y,s),false,u.region)){t=false}}if(t){if(!b.Lang.isBoolean(u.hidden_by_overflow)){u.hidden_by_overflow=k(v,u.region)}if(u.hidden_by_overflow){t=false}}if(!x){h(w,u)}return t};a=(function(){var s=false,u={},A,t,B,z,w,v,y,x;A=function(){if(!s){y=f.register("scroll",w);x=f.register("resize",w);s=true}};t=function(){if(s){y.detach();x.detach();s=false}};B=function(E){var C,D;if(u[E]){delete u[E];D=true;for(C in u){if(u.hasOwnProperty(C)){D=false;break}}if(D){t()}return true}return undefined};z=function(D){var C=u[D];if(b.Lang.isObject(C)){if(n(C.node,C.threshold)){C.callback.call(C.oScope,C.arg);B(D)}}};w=function(){for(var C in u){if(u.hasOwnProperty(C)){z(C)}}};v=function(E,D,C){if(b.Lang.isObject(u[E])){u[E][D]=C;return true}return undefined};return function(G,I,D,C,E){var F,H;G=b.one(G);if(!b.Lang.isObject(G)||!b.Lang.isFunction(I)){return false}D=D?p(D):[0,0];if(!C){C=G}if(E===true){E=C}if(!b.Lang.isObject(E)){E=window}A();F={node:G,callback:I,threshold:D,arg:C,oScope:E};H=b.guid();u[H]=F;b.later(0,window,z,H);return{cancel:function(){return B(H)},set:function(K,J){return v(H,K,J)},check:function(){return z(H)}}}}());p=function(s){if(b.Lang.isNumber(s)){s=[s,s]}if(!b.Lang.isArray(s)||!b.Lang.isNumber(s[0])||!b.Lang.isNumber(s[1])){s=[0,0]}return s};q=function(t,s,v){var u,w;if(!t instanceof b.Node){return false}if(!t.inViewportRegion(true)){s=!!s;v=b.Lang.isNumber(v)?v:0;e.setTimeout(function(){if(!b.Anim){t.scrollIntoView(s)}else{if(s){w=t.getY()-v}else{w=t.getY()+t.get("offsetHeight")-t.get("winHeight")+5}u=new b.Anim({node:b.one("window"),to:{scroll:[0,w]},duration:0.3,easing:b.Easing.easeOut});u.run()}},0)}return t};o=function(s){this._node=s.host};o.NS="vis";o.NAME="NodeVisibilityPlugin";o.prototype={isVisible:function(s){return n(this._node,s)},onVisible:function(v,t,s,u){return a(this._node,v,t,s,u)},animScrollIntoView:function(s,t){return q(this._node,s,t)},destroy:function(){}};b.Node.plug(o)},"0.0.1",{requires:["node","node-pluginhost","better-throttle","cache-simple"],optional:["anim","anim-scroll"]});YUI.add("personmenu-transjax",function(b){var a={svn_bump:"",error_timeout:'Uh oh! There was a problem contacting the server.',error_getting:'Uh oh! There was a problem getting data from the server.'};b.transjax.add("personmenu",a)},"0.0.1",{requires:["transjax-base"]});YUI.add("personmenu-rapid",function(a){a.on("personmenu:show",function(b){if(b){a.rapidTracker.addModules(b)}})},"0.0.1",{requires:F.config.modules["personmenu-rapid"].requires||[]});YUI.add("personmenu",function(c){var u,H,o,y,d,Q,A,x,F,S;function O(U){if(!O.is_init){H={open_on_icon_click:false,get_data_on_arrow_hover:true,show_delay:100,hide_delay:500,spinner_delay:200,io_timeout:10000,io_cache_ttl:120000,zeus:false};if(!c.Lang.isObject(U)){U={}}H=c.mix(U,H);u=c.one("body");if(c.config.flickr.user.nsid||c.config.flickr.flags.enable_grease){u.on("mouseover",b);u.on("mouseout",b);u.on("click",t);c.on("resize",t);c.on("contact_changer:change",L);c.on("contact_changer:open",M);c.on("PageContext:set",g)}O.is_init=true}}function h(V){var U,W;if(!h.cache){h.cache=new c.CacheSimple()}U=h.cache;if(c.Lang.isString(V)){W=U.retrieve(V);if(W&&W.response&&(new Date()).getTime()<W.payload.expires){return W.response}else{return null}}else{return U}}function f(U,V){if(!c.Lang.isString(U)){return false}h().add(U,V,{expires:(new Date()).getTime()+H.io_cache_ttl});return true}function n(U){f(U,null)}function B(U){return(function(){var V;return function(){var Y,Z,X,W;if(!V||arguments.length!==V.length){Y=true}else{X=Array.prototype.slice.call(arguments);W=Array.prototype.slice.call(V);for(Z in X){if(X.hasOwnProperty(Z)){if(X[Z]!==W[Z]){Y=true;break}}}}if(Y){U.apply(this,arguments)}V=arguments}}())}function l(U){if(c.Lang.isString(U)){U=c.one(U)}if(!U instanceof c.Node){return false}return U}function b(U){if(!U.target.hasClass("personmenu-trigger")){return}switch(U.type){case"mouseover":if((d||A)&&Q){return}C(U.target);break;case"mouseout":N();break}}function L(U){n(U.nsid)}function z(U){switch(U.type){case"mouseover":T();if(H.get_data_on_arrow_hover){if(c.one(".personmenu .personmenu-arrow")&&(U.target.test(".personmenu .personmenu-arrow")||c.one(".personmenu .personmenu-arrow").contains(U.target))){if(!d&&!h(o)){P(o)}}}break;case"mouseout":if(!d&&!A){I()}break;case"click":if(c.one(".personmenu .personmenu-arrow")&&(U.target.test(".personmenu .personmenu-arrow")||c.one(".personmenu .personmenu-arrow").contains(U.target))){U.preventDefault();w()}else{if(H.zeus&&(c.one(".personmenu .personmenu-more")&&(U.target.test(".personmenu .personmenu-more")||c.one(".personmenu .personmenu-more").contains(U.target)))){if(!d){U.preventDefault();U.halt();k()}}else{if(H.open_on_icon_click&&c.one(".personmenu .personmenu-icon-link")&&(U.target.test(".personmenu .personmenu-icon-link")||c.one(".personmenu .personmenu-icon-link").contains(U.target))){if(!d){U.preventDefault();k()}}else{if(c.one(".personmenu .personmenu-relationship-change")&&(U.target.test(".personmenu .personmenu-relationship-change")||c.one(".personmenu .personmenu-relationship-change").contains(U.target))){if(c.config.modules["contact-changer"]){U.preventDefault();s()}c.use("contact-changer",function(W){i();W.contact_changer.show(o)})}else{if(c.one(".personmenu .photos-trigger")&&U.target.test(".personmenu .photos-trigger")){var V=U.target.ancestor("li").one(".photos");if(V){U.preventDefault();V.toggleClass("photos-open")}}else{c.fire("personmenu:navigate",{id:p().get("id"),url:U.target.get("href")})}}}}}break}}function t(U){if(U.type==="click"){if(H.open_on_icon_click&&U.target.hasClass("personmenu-trigger")){U.preventDefault();U.halt();k(U.target)}else{if(Q&&!c.one(".personmenu").contains(U.target)){M()}}}if(U.type==="resize"){if(Q){m(y)}}}function g(U){if(U.newVal!==""){M()}}function T(){if(F){window.clearTimeout(F);F=null}}function N(){if(x){window.clearTimeout(x);x=null}}function C(U){T();N();if(Q&&!H.zeus){r(U)}else{x=window.setTimeout(function(){x=null;r(U)},H.show_delay)}}function I(){if(!F){F=window.setTimeout(function(){F=null;M()},H.hide_delay)}}function j(V){var U;V=l(V);U=V.get("data-defer-src")||V.get("src");return U}function R(V){var U;V=l(V);U=a(V);return U?"/photos/"+U:false}function a(W){var V,U;V=j(W);U=V.split("#")[1];return J(U)?U:false}function J(U){return(/^[0-9]+@N[0-9]{2}$/).test(U)}function p(){var U;if(!p.menu){if(H.zeus){U='<div class="personmenu personmenu-hidden personmenu-zeus"><div class="personmenu-hd"><a data-track="icon-link" href="" class="personmenu-icon-link rapidnofollow"><img class="personmenu-icon"></a><span class="personmenu-spinner"></span><span class="personmenu-name"></span></div><div class="personmenu-bd"></div></div>'}else{U='<div class="personmenu personmenu-hidden"><div class="personmenu-hd rapidnofollow"><a data-track="icon-link" href="" class="personmenu-icon-link rapidnofollow"><span class="personmenu-spinner"></span><img class="personmenu-icon"></a><a data-track="show-menu" href="" class="rapidnofollow personmenu-arrow" role="button"><span></span></a></div><span class="personmenu-hd-shadow"></span><div class="personmenu-bd"></div><span class="personmenu-bd-border-blocker"></span></div>'}c.one("body").append(U);p.menu=c.one(".personmenu");p.menu.on("mouseover",z);p.menu.on("mouseout",z);p.menu.on("click",z)}return p.menu}function w(){if(d){r()}else{k()}}function q(U,V){if(U){p().one(".personmenu-icon-link").set("href",U)}if(V){p().one(".personmenu-icon").set("src",V)}}q=B(q);function s(){A=true;p().addClass("personmenu-spinning");if(H.zeus){if(p().one(".personmenu-spinner")){p().one(".personmenu-spinner").addClass("personmenu-spinner-on")}}else{S=window.setTimeout(function(){p().one(".personmenu-spinner").addClass("personmenu-spinner-on");S=null},H.spinner_delay)}}function i(){A=false;if(S){window.clearTimeout(S);S=null}p().removeClass("personmenu-spinning");if(p().one(".personmenu-spinner")){p().one(".personmenu-spinner").removeClass("personmenu-spinner-on")}}function G(){Q=true;p().removeClass("personmenu-hidden")}function M(){Q=false;p().addClass("personmenu-hidden")}function m(U){var V,W;V=U.getXY();W=H.zeus?8:6;V[0]-=parseInt((48-U.get("width"))/2,10)+W;V[1]-=parseInt((48-U.get("height"))/2,10)+W;p().setStyle("position","absolute");p().setStyle("left",V[0]+"px");p().setStyle("top",V[1]+"px")}function D(U){var W,Y;W=R(U);Y=j(U);q(W,Y);if(H.zeus){var V=a(U);var X='<ul><li><a href="/people/'+V+'" class="personmenu-item">Profile</a></li><li><a href="'+W+'" class="personmenu-item">Photostream</a></li><li class="personmenu-sep-bottom"><a href="/photos/'+V+'/favorites" class="personmenu-item">Favorites</a></li><li><a href="" class="personmenu-item personmenu-more">More...</a></li></ul>';p().one(".personmenu-bd").set("innerHTML",X);p().one(".personmenu-name").set("innerHTML",V)}}D=B(D);function P(U){var X,W,V;P.in_progress_nsids=P.in_progress_nsids||{};X=P.in_progress_nsids;W={success:function(ab,aa,Y){var Z=aa.responseText;if(Z){f(Y,Z)}if(A&&o===Y){E(Y)}},failure:function(aa,Z,Y){if(A&&o===Y){if(Z.statusText==="timeout"){e(c.transjax.get("personmenu","error_timeout"))}else{e(c.transjax.get("personmenu","error_getting"))}}},end:function(Z,Y){delete X[Y]}};V="/personmenu_fragment.gne?nsid="+U+"&magic_cookie="+c.config.flickr.magic_cookie;if(H.zeus){V=V+"&zeus=1"}if(X[U]){return false}X[U]=U;c.io(V+"&cachebust="+(new Date()).getTime(),{timeout:H.io_timeout,on:W,"arguments":U})}function E(U){var V=h(U);if(V){if(H.zeus){p().set("innerHTML",V)}else{p().one(".personmenu-bd").set("innerHTML",V)}i();var W=y.getAttribute("data-menu-id");if(W){p().set("id",W)}else{W=false}c.fire("personmenu:show",W);v()}else{s();P(U)}}function e(V){var U='<div class="alert">'+V+"</div>";p().one(".personmenu-bd").set("innerHTML",U);i();v()}function r(U){var V;U=l(U)||y;if(!U){return false}y=U;V=a(U);if(!V){return false}o=V;i();K();D(U);m(U);G();if(H.zeus&&!h(V)){P(V)}return true}function k(U){var V;U=l(U)||y;if(!U){return false}y=U;V=a(U);if(!V){return false}o=V;r(U);E(V);return true}function K(){p().addClass("personmenu-closed");p().removeClass("personmenu-open");d=false}function v(){p().removeClass("personmenu-closed");p().addClass("personmenu-open");d=true;p().one(".personmenu-bd").vis.animScrollIntoView()}c.personmenu={init:O,showClosed:r,showOpen:k,hide:M}},"0.0.1",{requires:["node","anim","anim-scroll","node-visibility","event-custom","cache-simple","io-base","personmenu-transjax","personmenu-css"],optional:["contact-changer"]});(function(){var a="flickr";YUI.add(a,function(c){function b(){c.FlickrApp.init();if(c.config.flickr.flags.enable_grease||c.config.flickr.user&&c.config.flickr.user.nsid){c.personmenu.init()}if(c.config.flickr.sharing.use_share_this_v3){c.use("share-this-v3-menu",function(d){d.shareThisV3Menu.init()});if(c.config.flickr.sharing.share_immediately_service){c.use("share-this-v3-dialog",function(d){var e=d.config.flickr.sharing.share_immediately_service;d.shareThisV3Dialog.share_by_service(e.service_id,e.service_type_id)})}}if(c.config.flickr.flags.enable_tumblr_trackr){c.use("tumblr-trackr",function(d){d.tumblrTrackr.init()})}if(c.config.flickr.flags.view_count_on_visible){c.ViewCount.onVisible("img.view-count-on-visible")}c.tooltips.init();if(c.config.flickr.flags.enable_sitekey_fetcher){window.setInterval(function(){if(c.config.flickrAPI&&c.config.flickrAPI.api_key){c.use("gallery-flickr-api",function(e){var g,d,f;g="flickr.site.getKey";d={};f={success:function(h){if(h&&h.data&&h.data.key&&h.data.key._content&&e.Lang.isString(h.data.key._content)){e.config.flickrAPI.api_key=h.data.key._content}},failure:function(h){}};e.flickrAPI.callMethod(g,d,f)})}},7*60*60*1000)}}c.flickr=b},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());YUI.add("popup-login",function(a){var e="/photo_grease_postlogin.gne",h=false,q=false,o=false,r,p="head-upload-link",c="signin-popup",l=/cookie_session=[^;]+/gi,b=a.global_dialog;function n(){var s={method:"post",data:"random=0",on:{success:function(v,u,t){if(u&&(u.responseText==="1,1"||u.responseText==="1,0")){a.fire("login:authenticated",u.responseText)}else{d()}}}};a.later(100,this,g);a.io("/fragment.gne?name=social-auth-fragment",s)}function g(){if(b){b.show({loading:true,modal:true})}}function d(){if(b){b.hide()}}function k(v){if(a.config.flickr.is_touch_device){var u=e+"?d="+window.location+"&notpopup=1";window.location=v+"?popup=0&redir="+encodeURIComponent(u);return false}var t=v+"?popup=1&redir="+e+"?d="+window.location;try{r=window.open(t,"newWindow","width=650,height=650,resizable=1,scrollbars=1,location=yes")}catch(w){return true}try{if(r.focus){r.focus()}}catch(s){}a.later(500,this,function(){if(!r||r.closed||typeof r.closed==="undefined"||!h){var x=e+"?d="+window.location+"&notpopup=1";window.location=v+"?popup=0&redir="+encodeURIComponent(x)}});return false}function i(){a.later(20,this,f);q=true;k("/signin")}var j=0;function f(){if(document.cookie.match(l)){q=false;n()}else{a.later(20,this,f)}}function m(){if(a.config.flickr.user.nsid){return}a.one("body").on("click",function(u){var t=u.target.get("id");if(u.target.ancestor("."+c,true)){u.preventDefault();u.halt();i()}else{if(t===p){o=true;u.halt();i()}}});var s=a.one("window");s.on("login|blur",function(t){h=true});s.on("login|focus",function(t){h=false;if(q){n()}});a.on("login:authenticated",function(t){if(t==="1,1"){window.location="/"}else{if(o){window.location="/photos/upload"}else{window.location.reload()}}})}a.popup_login={init:m}},"0.0.1",{requires:["node","event","io-base"]});YUI.add("liquid-resizer",function(b){function a(c){b.on("resize",b.betterThrottle(function(){var d=F.liquid.resizePage(true);b.fire("Liquid:resize",d)},20))}b.liquidResizer={init:a}},"0.0.1",{requires:F.config.modules["liquid-resizer"].requires||[],optional:F.config.modules["liquid-resizer"].optional||[]});/*
YUI 3.5.1 (build 22)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("json-stringify",function(b){var j=(b.config.win||{}).JSON,N=b.Lang,p=N.isFunction,I=N.isObject,v=N.isArray,k=Object.prototype.toString,C=(k.call(j)==="[object JSON]"&&j),F=!!C,D="undefined",r="object",A="null",L="string",B="number",x="boolean",l="date",E={"undefined":D,"string":L,"[object String]":L,"number":B,"[object Number]":B,"boolean":x,"[object Boolean]":x,"[object Date]":l,"[object RegExp]":r},g="",q="{",a="}",y="[",i="]",s=",",c=",\n",m="\n",G=":",h=": ",u='"',d=/[\x00-\x07\x0b\x0e-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n=[[/\\/g,"\\\\"],[/\"/g,'\\"'],[/\x08/g,"\\b"],[/\x09/g,"\\t"],[/\x0a/g,"\\n"],[/\x0c/g,"\\f"],[/\x0d/g,"\\r"]],t=n.length,f={},o,H;function O(P){var e=typeof P;return E[e]||E[k.call(P)]||(e===r?(P?r:A):D);}function K(e){if(!f[e]){f[e]="\\u"+("0000"+(+(e.charCodeAt(0))).toString(16)).slice(-4);o[e]=0;}if(++o[e]===H){n.push([new RegExp(e,"g"),f[e]]);t=n.length;}return f[e];}function w(Q){var e,P;for(e=0;e<t;e++){P=n[e];Q=Q.replace(P[0],P[1]);}return u+Q.replace(d,K)+u;}function z(e,P){return e.replace(/^/gm,P);}function J(P,X,e){if(P===undefined){return undefined;}var R=p(X)?X:null,W=k.call(e).match(/String|Number/)||[],Y=b.JSON.dateToString,V=[],T,S,U;o={};H=b.JSON.charCacheThreshold;if(R||!v(X)){X=undefined;}if(X){T={};for(S=0,U=X.length;S<U;++S){T[X[S]]=true;}X=T;}e=W[0]==="Number"?new Array(Math.min(Math.max(0,e),10)+1).join(" "):(e||g).slice(0,10);function Q(ab,ah){var af=ab[ah],aj=O(af),ae=[],ad=e?h:G,ac,aa,ai,Z,ag;if(I(af)&&p(af.toJSON)){af=af.toJSON(ah);}else{if(aj===l){af=Y(af);}}if(p(R)){af=R.call(ab,ah,af);}if(af!==ab[ah]){aj=O(af);}switch(aj){case l:case r:break;case L:return w(af);case B:return isFinite(af)?af+g:A;case x:return af+g;case A:return A;default:return undefined;}for(aa=V.length-1;aa>=0;--aa){if(V[aa]===af){throw new Error("JSON.stringify. Cyclical reference");}}ac=v(af);V.push(af);if(ac){for(aa=af.length-1;aa>=0;--aa){ae[aa]=Q(af,aa)||A;}}else{ai=X||af;aa=0;for(Z in ai){if(ai.hasOwnProperty(Z)){ag=Q(af,Z);if(ag){ae[aa++]=w(Z)+ad+ag;}}}}V.pop();if(e&&ae.length){return ac?y+m+z(ae.join(c),e)+m+i:q+m+z(ae.join(c),e)+m+a;}else{return ac?y+ae.join(s)+i:q+ae.join(s)+a;}}return Q({"":P},"");}if(C){try{F=("0"===C.stringify(0));}catch(M){F=false;}}b.mix(b.namespace("JSON"),{useNativeStringify:F,dateToString:function(P){function e(Q){return Q<10?"0"+Q:Q;}return P.getUTCFullYear()+"-"+e(P.getUTCMonth()+1)+"-"+e(P.getUTCDate())+"T"+e(P.getUTCHours())+G+e(P.getUTCMinutes())+G+e(P.getUTCSeconds())+"Z";},stringify:function(Q,e,P){return C&&b.JSON.useNativeStringify?C.stringify(Q,e,P):J(Q,e,P);},charCacheThreshold:100});},"3.5.1",{requires:["yui-base"]});YUI.add("gallery-storage-lite",function(b){var s=b.config.doc,j=b.config.win,c=b.JSON,r=b.namespace("StorageLite"),i="yui_storage_lite",v="YUI StorageLite data",y=1048576,p="1.0",t="ready",x=0,h=1,a=2,m=3,k=4,f="yui_storage_lite",l="data",u={},n,g;try{if(j.localStorage){g=h}else{if(j.globalStorage){g=a;var o=j.globalStorage[j.location.hostname]}else{if(j.openDatabase&&navigator.userAgent.indexOf("Chrome")===-1){g=m}else{if(b.UA.ie>=5){g=k}else{g=x}}}}}catch(q){g=x}b.StorageFullError=function(d){b.StorageFullError.superclass.constructor.call(d);this.name="StorageFullError";this.message=d||"Maximum storage capacity reached";if(b.UA.ie){this.description=this.message}};b.extend(b.StorageFullError,Error);b.augment(r,b.EventTarget,true,null,{emitFacade:true,prefix:"storage-lite",preventable:false});r.publish(t,{fireOnce:true});b.mix(r,{clear:function(){},getItem:function(e,d){return null},length:function(){return 0},removeItem:function(d){},setItem:function(d,e){}});if(g===h||g===a){b.mix(r,{length:function(){return n.length},removeItem:function(d){n.removeItem(d)},setItem:function(e,w,d){n.setItem(e,d?c.stringify(w):w)}},true);if(g===h){n=j.localStorage;b.mix(r,{clear:function(){n.clear()},getItem:function(w,e){try{return e?c.parse(n.getItem(w)):n.getItem(w)}catch(d){return null}}},true)}else{if(g===a){n=j.globalStorage[j.location.hostname];b.mix(r,{clear:function(){for(var d in n){if(n.hasOwnProperty(d)){n.removeItem(d);delete n[d]}}},getItem:function(w,e){try{return e?c.parse(n[w].value):n[w].value}catch(d){return null}}},true)}}r.fire(t)}else{if(g===m||g===k){b.mix(r,{clear:function(){u={};r._save()},getItem:function(e,d){return u.hasOwnProperty(e)?u[e]:null},length:function(){var e=0,d;for(d in u){if(u.hasOwnProperty(d)){e+=1}}return e},removeItem:function(d){if(u){delete u[d];r._save()}else{u={}}},setItem:function(e,w,d){u[e]=w;r._save()}},true);if(g===m){n=j.openDatabase(i,p,v,y);b.mix(r,{_save:function(){n.transaction(function(d){d.executeSql("REPLACE INTO "+i+" (name, value) VALUES ('data', ?)",[c.stringify(u)])})}},true);n.transaction(function(d){d.executeSql("CREATE TABLE IF NOT EXISTS "+i+"(name TEXT PRIMARY KEY, value TEXT NOT NULL)");d.executeSql("SELECT value FROM "+i+" WHERE name = 'data'",[],function(z,w){if(w.rows.length){try{u=c.parse(w.rows.item(0).value)}catch(e){u={}}}r.fire(t)})})}else{if(g===k){n=s.createElement("span");n.addBehavior("#default#userData");b.mix(r,{_save:function(){var e=c.stringify(u);try{n.setAttribute(l,e);n.save(f)}catch(d){throw new b.StorageFullError()}}},true);b.on("domready",function(){s.body.appendChild(n);n.load(f);try{u=c.parse(n.getAttribute(l))}catch(d){u={}}r.fire(t)})}}}else{r.fire(t)}}},"1.0.0",{requires:["event-base","event-custom","event-custom-complex","json"]});YUI.add("occult",function(e){if(typeof window.FLICKR==="undefined"){window.FLICKR={};var d=window.FLICKR}function c(){var f=arguments,l=null,h,g,k;for(h=0;h<f.length;h=h+1){k=(""+f[h]).split(".");l=FLICKR;for(g=(k[0]=="FLICKR")?1:0;g<k.length;g=g+1){l[k[g]]=l[k[g]]||{};l=l[k[g]]}}return l}function b(h,l){c(h);var g=h.split("."),f=g.length,k=FLICKR;for(var j=0;j<g.length-1;j++){k=k[g[j]]}k[g[f-1]]=l}function a(f,g){return d[f]}e.occult={register:b,get:a}},"0.0.1",{});YUI.add("photo-transjax",function(a){a.transjax.add("photo",{your_favorites:'Your favorites',untitled:'Untitled',window_title:'%s | Flickr - Photo Sharing!'})},"0.0.1",{requires:["transjax-base"]});(function(){var a="type-cast";YUI.add(a,function(h){function e(i){if(h.Lang.isNumber(i)){i=i+""}return h.Lang.isString(i)?i:""}function c(i){if(i==="0"){i=0}return !!i}function d(i){i=parseInt(i,10);if(!h.Lang.isNumber(i)){return undefined}return i}function f(i){i=d(i);if(!h.Lang.isNumber(i)||i<0||i>3){return undefined}return i}function b(i){return h.Lang.isArray(i)?i:[]}function g(i){return h.Lang.isObject(i)?i:{}}h.TypeCast={string:e,bool:c,integer:d,integer0123:f,arr:b,obj:g}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());(function(){var a="urls";YUI.add(a,function(b){var h={photo:/^\/photos\/([^\/]+)\/(\d+)(?:\/in\/([^\/]+))?(?:(?:\/page(\d+))|(?:\/(lightbox))|(?:\/(tour)))?/,photostream:/^\/photos\/([^\/]+)(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?/,delete_photo:/^\/photos\/([^\/]+)\/?\?delete=(\d+)(?:&context=([^&]+))?/,faves:/^\/photos\/([^\/]+)\/favorites(?:\/from\/([^\/]+))?(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/,explore:/^\/explore\/?(\d{4}\/\d{2}\/\d{2})?(?:\/?with\/([0-9]+))?\/?(lightbox\/?)?/,group_pool:/^\/groups\/([^\/]+)\/(?:pool)?(?:\/((?:(?!with|page|lightbox)[^\/\?])+))?(?:\/with\/(\d+))?(?:\/page(\d+))?(\/lightbox)?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/,gallery:/^\/photos\/([^\/]+)\/galleries\/([0-9]+)(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?/,contacts:/^\/photos\/(?:friends|contacts)(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/,contactsfaves:/^\/photos\/contacts\/favorites(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/};function e(r,t){var q,s={};if(!h[r]){b.log('[urls] no regex found for page_type "'+r+'"');return}q=h[r].exec(t);switch(r){case"photo":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.photo_id=q[2];s.context_id=q[3]&&decodeURIComponent(q[3]);s.page=q[4];s.lightbox=q[5]?true:false;s.tour=q[6]?true:false;break;case"photostream":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.page=q[2];s.photo_id=q[3];s.lightbox=q[4]?true:false;break;case"delete_photo":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.photo_id=q[2];s.context_id=q[3];break;case"faves":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.from=q[2]&&decodeURIComponent(q[2]);s.page=q[3];s.photo_id=q[4];s.lightbox=q[5]?true:false;s.view_mode=q[6];break;case"group_pool":s.group_id=q[1]&&decodeURIComponent(q[1]);s.owner_id=q[2]&&decodeURIComponent(q[2]);s.photo_id=q[3];s.page=q[4];s.lightbox=q[5]?true:false;s.view_mode=q[6];break;case"gallery":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.gallery_id=q[2]&&decodeURIComponent(q[2]);s.page=q[3];s.photo_id=q[4];s.lightbox=q[5]?true:false;break;case"contacts":s.page=q[1];s.photo_id=q[2];s.lightbox=q[3]?true:false;s.view_mode=q[4];break;case"contactsfaves":s.page=q[1];s.photo_id=q[2];s.lightbox=q[3]?true:false;s.view_mode=q[4];break;case"explore":s.date=q[1];s.photo_id=q[2];s.lightbox=q[3]}return s}function c(s,r){var q;r=r||{};if(r.photo&&b.Lang.isString(r.photo)){r.photo_id=r.photo;if(b.PhotoData){r.photo=b.PhotoData.get(r.photo)}if(!b.Lang.isObject(r.photo)){r.photo=undefined;delete r.photo}}if(b.Lang.isObject(r.photo)){r.photo_id=r.photo.get("id")}switch(s){case"photo":q=p(r);break;case"photostream":q=l(r);break;case"delete_photo":q=o(r);break;case"faves":q=n(r);break;case"group_pool":q=i(r);break;case"gallery":q=d(r);break;case"contacts":q=m(r);break;case"contactsfaves":q=k(r);break;case"explore":q=g(r);break}return q}function p(v){var s,t,u,r,z,x,B,y,A,w,q;s=v.photo;t=v.photo_id;u=v.path_alias;if(!b.Lang.isObject(s)&&!t){b.log("[urls] missing photo object or ID");return}if(!b.Lang.isObject(s)&&!u){b.log("[urls] missing photo object or path alias");return}t=t||s.get("id");u=u||s.get("pathalias")||s.get("owner");if(v.context){if(b.Lang.isString(v.context)){r=v.context}else{if(b.Lang.isObject(v.context)&&b.Lang.isString(v.context.id)){r=v.context.id}}}if(v.page){z=parseInt(v.page,10);if(z===1||!b.Lang.isNumber(z)){z=false}}x=b.Lang.isBoolean(v.lightbox)?v.lightbox:false;B=(b.Lang.isBoolean(v.sizes)||b.Lang.isString(v.sizes))?v.sizes:false;y=b.Lang.isString(v.hash)?v.hash:false;A=b.Lang.isBoolean(v.exif)?v.exif:false;w=b.Lang.isBoolean(v.faves)?v.faves:false;q=b.Lang.isBoolean(v.details)?v.details:false;return"/photos/"+u+"/"+t+"/"+(B?"sizes/"+(b.Lang.isString(B)?B+"/":""):"")+(A?"meta/":"")+(w?"favorites/":"")+(q?"edit-details/":"")+(r?("in/"+r+"/"):"")+(z?"page"+z+"/":"")+(x?"lightbox/":"")+(y?"#"+y:"")}function l(r){var s,q;if(r.photo){r.path_alias=r.photo.get("pathalias")||r.photo.get("owner")}s=r.path_alias;if(!s){b.log("[urls] missing path_alias");return}q="/photos/"+s+"/";if(r.tag){if(b.Lang.isArray(r.tag)){r.tag=r.tag.join(",")}q+="tags/"+r.tag+"/"}else{if(r.photo_id){q+="with/"+r.photo_id+"/"}}if(r.lightbox){q+="lightbox/"}return q}function o(r){var s,q;s=r.path_alias;if(!s){b.log("[urls] missing path_alias");return}photo_id=r.photo_id;if(!photo_id){b.log("[urls] missing photo_id");return}context_id=r.context_id;q="/photos/"+s+"/?delete="+photo_id+(context_id?"&context="+context_id:"")+"&magic_cookie="+b.config.flickr.magic_cookie;return q}function n(r){var s,q;s=r.path_alias;if(!s){b.log("[urls] missing path_alias");return}q="/photos/"+s+"/favorites/";if(r.from){q+="from/"+r.from+"/"}if(r.page){q+="page"+r.page+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function i(r){var s,q;s=r.group_id;if(!s){b.log("[urls] missing group_id");return}q="/groups/"+s+"/pool/";if(r.owner_id){q+=r.owner_id+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.page){q+="page"+r.page+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function m(r){var q;q="/photos/friends/";if(r.page){q+="page"+r.page+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function k(r){var q;q="/photos/contacts/favorites/";if(r.page){q+="page"+r.page+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function d(s){var t,q,r;t=s.path_alias;q=s.gallery_id;if(!t){b.log("[urls] missing path_alias");return}if(!q){b.log("[urls] missing gallery_id");return}r="/photos/"+t+"/galleries/"+q+"/";if(s.photo_id){r+="with/"+s.photo_id+"/"}if(s.lightbox){r+="lightbox/"}return r}function g(s){var r,t,q;r=s.date;t=s.with_id;q="/explore";if(r){q+="/"+r}if(t){q+="/with/"+t}if(s.lightbox){q+="lightbox/"}return q}function j(r){if(!b.Lang.isNumber(r)){r=parseInt(r,10)}var q="",t="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var u=r,s;while(r>=58){u=r/58;s=r-(58*Math.floor(u));q=""+t.substr(s,1)+q;r=Math.floor(u)}return(u)?""+t.substr(u,1)+q:q}function f(v){var u="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var r=v.length;var q=0;var t=1;for(var s=(r-1);s>=0;s--){q=q+t*u.indexOf(v[s]);t=t*u.length}return q}b.urls={get:c,parse:e,getShortID:j,getLongID:f,regexes:h}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());(function(){var a="grease";YUI.add(a,function(d){var V=false,Q,aj,N=d.StorageLite,R=false,s,t,y,O,U,C="pc",u="pf",g="pct",P="ps",W="ps3",j="pp",q="pps",X="/photo_grease_postlogin.gne",x="fave",ab="contact",ac="share",D="share_v3",h="comment",e=/cookie_session=[^;]+/gi,l=";",al=3,M=1000,J=[C,P,W,u,g,u,j,q];if(d.config.flickr.flags.enable_grease){V=true}O=d.global_dialog;function p(){d.Array.each(J,function(Y){N.removeItem(Y)})}var af=(function(){var Y=null,aw=false,ao=0,aq=false,ap=false;function au(){M=(M>=10000)?M:M*2;return M}function av(){if(ap){if(Y){O.remove_existing_dialog();Y.cancel();aw=false}ap=false}}function ar(){ap=false;if(Y){Y.cancel()}av();O.remove_existing_dialog();aw=false;Y=null;aq=false;ao=0;M=1000;aq=false}function an(){if(Y){Y.cancel()}aq=true;d.fire("grease:cancel")}function at(){if(aq){return}if(Y){Y.cancel();Y=null}var ax={method:"post",data:"random=0",on:{success:function(aA,az,ay){if(az&&az.responseText.substring(0,1)==="1"){d.fire("grease:authenticated")}else{if(ao++<al){m();if(!Y){Y=d.later(au(),this,at)}}}},failure:function(){if(ao++<1){if(!Y){Y=d.later(au(),this,at)}}}}};d.io("/fragment.gne?name=social-auth-fragment",ax)}return{start:function(){if(!ap){ap=true;at()}else{M=50;Y&&Y.cancel();at();return}},stop:av,cancel:an,pause:function(){Y&&Y.cancel();M=1000000},canceled:aq,reset:ar}}());function ad(Y){if(!V){return}if(Y&&d.config.flickr.user.nsid){N.on("storage-lite:ready",function(){var ao=ae(C),ay=ae(u),aq=ae(g),au=ae(P,true),at=ae(W,true),an=ae(j),ax=ae(q);if(ao){y="comment";var aw=ao.indexOf(";"),ap=ao.substring(0,aw),av=ao.substring(aw+1);if(ap===d.photo.getCurrentPhoto().get("id")){Z(av)}}else{if(ay){y="fave";T(ay)}else{if(aq){y="contact";o(aq)}else{if(au){y="share";G(au)}else{if(at){y="sharev3";ah(at)}else{var ar=d.one("#global-dialog-background");if(ar){ar.setStyle("display","none")}p()}}}}}})}else{N.on("storage-lite:ready",function(){p()})}}function c(){d.detach("grease|*");Q=false;m();U(false);af.reset()}function f(Y){if(Y.target.hasClass("close-x")||Y.target.hasClass("Butt")){Y.preventDefault();Y.halt();d.global_dialog.hide()}}function z(){O.show({loading:true,modal:true})}function m(){O.hide()}function ai(an){var ao=d.one("body");var Y=ao.create('<img height="1" width="1" src="'+an+'">');ao.appendChild(Y)}function H(){O.create_dialog(d.one("#grease-confirm-"+y).get("innerHTML"),{width:355}).show({loading:false,modal:true});d.one("#global_dialog").on("click",f,this);d.later(10000,this,d.global_dialog.hide);if(d.config.flickr.flags.enable_rapid_tracking&&d.one("#reg-tour")){d.use("rapid-tracker",function(an){an.rapidTracker.addModules("grease-conversion-tracker");an.rapidTracker.beaconClick("grease-conversion-tracker",y);switch(y){case x:ai("https://pclick.internal.yahoo.com/p/s=2143640346&t="+Math.random());break;case ab:ai("https://pclick.internal.yahoo.com/p/s=2143640345&t="+Math.random());break;case ac:ai("https://pclick.internal.yahoo.com/p/s=2143640344&t="+Math.random());break;default:ai("https://pclick.internal.yahoo.com/p/s=2143640343&t="+Math.random())}})}}function T(Y){if(d.photo&&d.photo.getCurrentPhoto&&d.photo.getCurrentPhoto().get("is_owner")){O.remove_existing_dialog();var an=d.one("#global-dialog-background");if(an){an.setStyle("display","none")}p();return}H();if(!d.PhotoData.get(Y).get("is_fave")){d.PhotoData.get(Y).toggle_fave()}p()}function G(Y){z();p();d.flickrAPI.callMethod("flickr.sharing.share",Y,{success:function(an){m();H()},failure:r})}function ah(Y){z();p();Y.magic_cookie=d.config.flickr.magic_cookie;Y.from_grease=1;d.use("share-this-v3-dialog",function(an){an.shareThisV3Dialog.do_share_action(Y)})}function r(){p();O.create_dialog(d.one("#grease-error").get("innerHTML")).show({loading:false,modal:true,width:355,style:"grease-error"});d.one("#global_dialog").on("click",f,this);d.later(5000,this,d.global_dialog.hide)}function o(Y){z();contactArr=Y.split(";");d.flickrAPI.callMethod("flickr.contacts.add",{user_id:contactArr[0],friend:contactArr[1],family:contactArr[2]},{success:function(an){m();H();p()},failure:r})}function n(){if(document.cookie.match(e)){Q=false;z();checkAuth()}else{d.later(20,this,n)}}function Z(ao){z();p();var an=d.one("#message");if(!an){r();return}d.one("#message").set("innerHTML",ao);var Y={method:"post",data:"preview=0",form:{id:d.one(".add-comment-form form")},on:{success:function(au,at,aq){m();H();var ap=d.one("#comments");ap.set("innerHTML",at.responseText);var ar=ap.one(".Problem");if(ar){O.create_alert_dialog(ar.get("innerHTML"),function(){ap.one("#message").scrollIntoView()})}}}};d.io("/photo_comments_fragment.gne",Y)}function A(ap){var ao;af.reset();var an=ap+"&popup=1&redir="+X+"?d="+encodeURIComponent(window.location+"?reg=1")+"&src="+y;if(d.config.flickr.is_touch_device){ao=X+"?d="+window.location+"&notpopup=1&src="+y+"&reg=1";window.location=ap+"&popup=0&redir="+encodeURIComponent(ao);return false}try{aj=window.open(an,"newWindow","width=650,height=650,resizable=1,scrollbars=1,location=yes")}catch(ar){return true}try{if(aj.focus){aj.focus()}}catch(Y){}if(!aj||aj.closed||typeof aj.closed==="undefined"){ao=X+"?d="+window.location+"&notpopup=1&src="+y+"&reg=1";window.location=ap+"&popup=0&redir="+encodeURIComponent(ao)}var aq=d.one("window");aq.on("grease|focus",function(){if(!af.canceled){af.start()}if(!document.cookie.match(e)){m();U(false);n()}});d.on("grease:cancel",function(at){Q=false;c()});aq.on("grease|blur",function(){if(!af.canceled){af.pause()}});aq.on("grease:timeout",function(at){Q=false;c()});d.on("grease:authenticated",function(aw){z();Q=false;U(true);var ax=(W),at=["reg=1","src="+y];if(ax){var av=window.location.toString(),au=av.match(/\?/i);av+=(!au?"?":"&")+at.join("&");window.location=av}else{window.location=d.urls.get("photo",{photo:d.photo.getCurrentPhoto()})+"?"+at.join("&")}});return false}function b(ao,ap,an){var Y=an||false;N.setItem(ao,ap,Y)}function ae(Y,ao){var an=ao||false;return N.getItem(Y,an)}function E(Y){if(!Q){af.reset();U=Y||function(){};d.global_dialog.remove_existing_dialog();d.global_dialog.show({loading:true,modal:true});Q=true;A("/signin?src="+y+"&reg=1")}else{c();E(Y)}}function K(Y){p();b(C,d.photo.getCurrentPhoto().get("id")+l+Y);y="comment"}function w(Y){p();b(u,Y);y="fave"}function aa(Y){p();if(d.Lang.isArray(Y)){b(g,Y.join(";"));y="contact"}}function S(Y){p();b(P,Y,true);y="share"}function ag(Y){p();b(W,Y,true);y="sharev3"}function v(Y){p();b(j,Y);y="party"}function am(Y){p();b(q,d.JSON.stringify(Y));y="partyStart"}d.grease={init:ad,enabled:V,authenticate:E,postComment:K,addFave:w,addContact:aa,share:S,shareV3:ag,photoParty:v,photoPartyStart:am};if(d.config.flickr.user.admin_user==="saw"){d.occult.register("postComment",function(Y){Z(Y)});d.occult.register("showdialog",function(Y){y="fave";H()});d.occult.register("fakeerror",function(Y){r(Y)})}var i=d.one("#reg-tour");function k(){for(var Y=1;Y<4;Y++){ak.removeClass(I+Y)}}function L(Y){Y.preventDefault();k();d.Event.purgeElement("#reg-tour");i.addClass("hidden")}function B(Y){if(Y.test("#reg-tour")){return}if(Y.test("ol li")){k();switch(Y.get("id")){case"step-1":ak.addClass(I+1);break;case"step-2":ak.addClass(I+2);break;case"step-3":ak.addClass(I+3);break}}else{B(Y.get("parentNode"))}}if(i){var I="tour-step",ak=d.one("body");i.one(".close-x").on("click",L);i.on("mouseover",function(Y){B(Y.target)});i.on("mouseout",function(Y){k()})}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());YUI.add("photo-data",function(g){var b={},a=g.TypeCast;function f(i){var h;if(i instanceof d){h=i}else{if(b[i.id]){h=b[i.id];h.merge_data(i)}else{h=new d(i);b[i.id]=h}}return h}function c(h){if(typeof h==="undefined"){return b}else{return b[h]}}function e(h){return g.Lang.isNumber(h)&&parseInt(h,10)===h}g.PhotoData={add:f,get:c};function d(h){d.superclass.constructor.apply(this,arguments)}d.NAME="PhotoData";d.ATTRS={id:{value:""},title:{broadcast:1,value:"",setter:function(i,h){i=a.string(i);return i.replace(/^\s+$/,"")}},description:{broadcast:1,value:"",setter:a.string},owner:{value:"",setter:function(h){if(!g.Lang.isString(h)){if(g.Lang.isObject(h)&&h.nsid){h=h.nsid}else{h=""}}return h}},ownername:{value:""},pathalias:{value:""},url:{value:"",getter:function(i,h){return g.urls.get("photo",{photo:this})}},date_posted:{broadcast:1,getter:a.integer},is_public:{broadcast:1,getter:a.bool},is_friend:{broadcast:1,getter:a.bool},is_family:{broadcast:1,getter:a.bool},perm_comment:{broadcast:1,getter:a.integer0123},perm_addmeta:{broadcast:1,getter:a.integer0123},perms:{getter:function(){return{is_public:this.get("is_public"),is_friend:this.get("is_friend"),is_family:this.get("is_family"),perm_comment:this.get("perm_comment"),perm_addmeta:this.get("perm_addmeta")}}},license:{broadcast:1,getter:a.integer,setter:a.integer},safety_level:{broadcast:1,getter:a.integer,setter:a.integer},needs_interstitial:{broadcast:1,value:false,getter:a.bool,setter:a.bool},media:{broadcast:1,value:"photo"},is_video:{getter:function(){return(this.get("media")==="video")}},secret:{value:""},deleted:{value:false},dmca_takedown:{value:false},geo:{broadcast:1,getter:function(h){if(!g.Lang.isObject(h)){h={}}return h}},has_geo:{getter:function(){var h=this.get("geo");return(h&&h.latitude&&h.longitude&&h.accuracy)}},exif_latlong:{},perm_viewgeo:{broadcast:1,value:false},is_bad:{broadcast:1,getter:a.integer,setter:a.integer},content_type:{broadcast:1,getter:a.integer,setter:a.integer},is_fave:{broadcast:1,value:false,setter:function(j,h){j=a.bool(j);var i=this.get(h);if(j!==i){if(j){this.increment("fave_count")}else{this.decrement("fave_count")}}if(this.get("fave_changes_pending")===0){this.set("is_confirmed_fave",j)}return j},getter:a.bool},is_confirmed_fave:{value:undefined},fave_changes_pending:{value:0},fave_count:{broadcast:1,value:0,getter:a.integer,setter:a.integer},comment_count:{broadcast:1,value:0,getter:a.integer,setter:a.integer},can_addmeta:{value:false,getter:a.bool},can_comment:{value:false,getter:a.bool},can_fave:{value:false,getter:function(){if(this.get("is_ignored")){return false}if(this.get("dmca_takedown")){return false}if(this.get("is_owner")){return false}if(!g.config.flickr.user.nsid&&!g.config.flickr.flags.enable_grease){return false}return true}},group_count:{broadcast:1,getter:a.integer,setter:a.integer},people_count:{broadcast:1,getter:a.integer,setter:a.integer},guestpass_count:{broadcast:1,getter:a.integer,setter:a.integer},is_owner:{value:false,getter:function(){return g.config.flickr.user.nsid&&g.config.flickr.user.nsid===this.get("owner")}},is_ignored:{value:false},tags:{broadcast:1,getter:a.arr},sizes:{value:{},getter:function(m,i){var j,l,h,k;m=a.obj(m);if(g.config.flickr.flags.enable_2048_images){j=m.o||m.l||m.z;if(j&&(j.width>=2048||j.height>=2048)){l=j.width/j.height;if(l>1){k=2048;h=Math.round(2048/l)}else{h=2048;k=Math.round(2048*l)}m["2048"]={url:m.t.url.replace("_t","_2048"),height:h+"",width:k+"",label:"2048"}}}return m}}};g.extend(d,g.Base,{initializer:function(h){this.merge_data(h)},merge_data:function(i){var j,h;if(typeof i.id!=="undefined"&&i.id!==this.get("id")){this.set("id",i.id)}if(typeof i.title!=="undefined"&&i.title!==this.get("title")){this.set("title",i.title)}if(typeof i.description!=="undefined"&&i.description!==this.get("description")){this.set("description",i.description)}if(typeof i.owner!=="undefined"&&i.owner!==this.get("owner")){this.set("owner",i.owner)}if(typeof i.ownername!=="undefined"&&i.ownername!==this.get("ownername")){this.set("ownername",i.ownername)}if(typeof i.pathalias!=="undefined"&&i.pathalias!==this.get("pathalias")){this.set("pathalias",i.pathalias)}if(typeof i.url!=="undefined"&&i.url!==this.get("url")){this.set("url",i.url)}if(typeof i.date_posted!=="undefined"&&i.date_posted!==this.get("date_posted")){this.set("date_posted",i.date_posted)}if(typeof i.date_taken!=="undefined"&&i.date_taken!==this.get("date_taken")){this.set("date_taken",i.date_taken)}if(typeof i.is_public!=="undefined"&&i.is_public!==this.get("is_public")){this.set("is_public",i.is_public)}if(typeof i.is_friend!=="undefined"&&i.is_friend!==this.get("is_friend")){this.set("is_friend",i.is_friend)}if(typeof i.is_family!=="undefined"&&i.is_family!==this.get("is_family")){this.set("is_family",i.is_family)}if(typeof i.can_comment!=="undefined"&&i.can_comment!==this.get("can_comment")){this.set("can_comment",i.can_comment)}if(typeof i.can_addmeta!=="undefined"&&i.can_addmeta!==this.get("can_addmeta")){this.set("can_addmeta",i.can_addmeta)}if(typeof i.perm_comment!=="undefined"&&i.perm_comment!==this.get("perm_comment")){this.set("perm_comment",i.perm_comment)}if(typeof i.perm_addmeta!=="undefined"&&i.perm_addmeta!==this.get("perm_addmeta")){this.set("perm_addmeta",i.perm_addmeta)}if(typeof i.license!=="undefined"&&i.license!==this.get("license")){this.set("license",i.license)}if(typeof i.needs_interstitial!=="undefined"&&i.needs_interstitial!==this.get("needs_interstitial")){this.set("needs_interstitial",i.needs_interstitial)}if(typeof i.safety_level!=="undefined"&&i.safety_level!==this.get("safety_level")){this.set("safety_level",i.safety_level)}if(typeof i.media!=="undefined"&&i.media!==this.get("media")){this.set("media",i.media)}if(typeof i.secret!=="undefined"&&i.secret!==this.get("secret")){this.set("secret",i.secret)}if(typeof i.is_bad!=="undefined"&&i.is_bad!==this.get("is_bad")){this.set("is_bad",i.is_bad)}if(typeof i.content_type!=="undefined"&&i.content_type!==this.get("content_type")){this.set("content_type",i.content_type)}if(typeof i.is_faved!=="undefined"&&i.is_faved!==this.get("is_fave")){this.set("is_fave",i.is_faved)}if(typeof i.is_fave!=="undefined"&&i.is_fave!==this.get("is_fave")){this.set("is_fave",i.is_fave)}if(typeof i.fave_count!=="undefined"&&i.fave_count!==this.get("fave_count")){this.set("fave_count",i.fave_count)}if(typeof i.count_faves!=="undefined"&&i.count_faves!==this.get("fave_count")){this.set("fave_count",i.count_faves)}if(typeof i.comment_count!=="undefined"&&i.comment_count!==this.get("comment_count")){this.set("comment_count",i.comment_count)}if(typeof i.count_comments!=="undefined"&&i.count_comments!==this.get("comment_count")){this.set("comment_count",i.count_comments)}if(typeof i.geo!=="undefined"&&i.geo!==this.get("geo")){this.set("geo",i.geo)}if(typeof i.exif_latlong!=="undefined"&&i.exif_latlong!==this.get("exif_latlong")){this.set("exif_latlong",i.exif_latlong)}if(typeof i.perm_viewgeo!=="undefined"&&i.perm_viewgeo!==this.get("perm_viewgeo")){this.set("perm_viewgeo",i.perm_viewgeo)}if(typeof i.woe!=="undefined"&&i.woe!==this.get("woe")){this.set("woe",i.woe)}if(typeof i.tags!=="undefined"&&i.tags!==this.get("tags")){this.set("tags",i.tags)}if(typeof i.group_count!=="undefined"&&i.group_count!==this.get("group_count")){this.set("group_count",i.group_count)}if(typeof i.people_count!=="undefined"&&i.people_count!==this.get("people_count")){this.set("people_count",i.people_count)}if(typeof i.guestpass_count!=="undefined"&&i.guestpass_count!==this.get("guestpass_count")){this.set("guestpass_count",i.guestpass_count)}if(i.sizes&&g.Lang.isObject(i.sizes)){j=i.sizes}else{j={};if(i.url_sq){j.sq={url:i.url_sq,width:parseInt(i.width_sq,10),height:parseInt(i.height_sq,10)}}if(i.url_t){j.t={url:i.url_t,width:parseInt(i.width_t,10),height:parseInt(i.height_t,10)}}if(i.url_s){j.s={url:i.url_s,width:parseInt(i.width_s,10),height:parseInt(i.height_s,10)}}if(i.url_m){j.m={url:i.url_m,width:parseInt(i.width_m,10),height:parseInt(i.height_m,10)}}if(i.url_z){j.z={url:i.url_z,width:parseInt(i.width_z,10),height:parseInt(i.height_z,10)}}if(i.url_l){j.l={url:i.url_l,width:parseInt(i.width_l,10),height:parseInt(i.height_l,10)}}if(i.url_h){j.h={url:i.url_h,width:parseInt(i.width_h,10),height:parseInt(i.height_h,10)}}if(i.url_k){j.k={url:i.url_k,width:parseInt(i.width_k,10),height:parseInt(i.height_k,10)}}if(i.url_o){j.o={url:i.url_o,width:parseInt(i.width_o,10),height:parseInt(i.height_o,10)}}if(i.media==="video"){if(i.height_v){j.v={width:parseInt(i.width_v,10),height:parseInt(i.height_v,10)}}}}if(g.Object.size(j)){h=this.get("sizes")||{};g.Object.each(h,function(k,l){if(j[l]){j[l]=g.merge(k,j[l])}});this.set("sizes",g.merge(h,j))}},toggle_fave:function(){var i=this,h,l,j,k;if(!this.get("can_fave")){return}if(g.config.flickr.flags.enable_grease&&!g.config.flickr.user.nsid){g.grease.addFave(this.get("id"));g.grease.authenticate();return}h=!this.get("is_fave");l="flickr.favorites."+(h?"add":"remove");j={photo_id:this.get("id")};k={success:function(){var m,n,o,p;m=i.get("id");i.decrement("fave_changes_pending");i.set("is_confirmed_fave",h);if(i.get("fave_changes_pending")===0){i.set("is_fave",h)}n="faves-"+(g.config.flickr.user.pathalias?g.config.flickr.user.pathalias:g.config.flickr.user.nsid);o=g.ContextData.getContext(n);if(o){p=o.getPhotoPosition(m)}if(h){if(o){if(g.ContextData.getPrevLimit(n)===p){g.ContextData.unremovePhoto(n,p)}else{g.ContextData.invalidate(n)}}else{if(g.config.flickr.page_type==="photo"&&i.get("id")===g.photo.getCurrentPhoto().get("id")){g.ContextData.add({id:n,user_id:g.config.flickr.user.nsid,type:"faves",title:g.transjax.get("photo","your_favorites"),url:g.config.flickr.user.photos_url+"favorites/",photos:[{position:"0",photo:i}]})}}}else{if(o&&g.Lang.isNumber(p)){g.ContextData.removePhoto(n,p)}}},failure:function(){i.decrement("fave_changes_pending");if(i.get("fave_changes_pending")===0){i.set("is_fave",i.get("is_confirmed_fave"))}}};this.set("is_fave",h);this.increment("fave_changes_pending");g.flickrAPI.callMethod(l,j,k)},record_interstitial_clickthrough:function(){var h=this.get("owner");g.Object.each(b,function(i,j){if(i.get("owner")===h){i.set("needs_interstitial",false)}});g.flickrAPI.callMethod("flickr.people.recordInterstitialClickthrough",{user_id:h},function(){})},updateWoeAttributeByeId:function(i){var h=this;g.use("flickr-geo",function(j){j.flickrGeo.getWoeById(i,function(k){if(k.success&&j.Lang.isObject(k.woe)){h.set("woe",k.woe)}else{j.log("Unable to update WOE. Expected data was not received from the API.","error","photo-data")}},this)})},increment:function(h){if(!e(this.get(h))){return false}return this.add(h,1)},decrement:function(h){if(!e(this.get(h))){return false}return this.add(h,-1)},add:function(i,j){var k=this.get(i),h;if(!g.Lang.isNumber(k)||!g.Lang.isNumber(j)){return false}h=k+j;if(this.set(i,h)){return h}else{return false}}})},"0.0.1",{requires:F.config.modules["photo-data"].requires||[],optional:F.config.modules["photo-data"].optional||[]});function udm_(J){var I="comScore=",H=document,G=H.cookie,F="",E="indexOf",D="substring",C="length",B=2048,A,z="&ns_",y="&",x,w,v,u,t=window,s=t.encodeURIComponent||escape;if(G[E](I)+1){for(v=0,w=G.split(";"),u=w[C];v<u;v++){x=w[v][E](I),x+1&&(F=y+unescape(w[v][D](x+I[C])))}}J+=z+"_t="+ +(new Date)+z+"c="+(H.characterSet||H.defaultCharset||"")+F,J[C]>B&&J[E](y)>0&&(A=J[D](0,B-8).lastIndexOf(y),J=(J[D](0,A)+z+"cut="+s(J[D](A+1)))[D](0,B)),H.images?(x=new Image,t.ns_p||(ns_p=x),x.src=J):H.write("<","p","><",'img src="',J,'" height="1" width="1" alt="*"',"><","/p",">")}typeof _comscore=="undefined"&&(_comscore=[]),function(){var v="length",u=self,t=u.encodeURIComponent?encodeURIComponent:escape,s=".scorecardresearch.com",r=Math,q="script",p="width",o=/c2=(\d*)&/,n,m=function(D){if(!!D){var C,B=[],A,z=0,y,x,w="";for(var d in D){A=typeof D[d];if(A=="string"||A=="number"){B[B[v]]=d+"="+t(D[d]),d=="c2"?w=D[d]:d=="c1"&&(z=1)}}if(B[v]<=0||w==""){return}x=D.options||{},x.d=x.d||document;if(typeof x.url_append=="string"){y=x.url_append.replace(/&amp;/,"&").split("&");for(var d=0,c=y[v],a;d<c;d++){a=y[d].split("="),a[v]==2&&(B[B[v]]=a[0]+"="+t(a[1]))}}C=["http",x.d.URL.charAt(4)=="s"?"s://sb":"://b",s,"/p?",z?"":"c1=2&",B.join("&").replace(/&$/,"")],udm_(C.join(""))}},l=function(a){a=a||_comscore;for(var f=0,e=a[v];f<e;f++){m(a[f])}a=_comscore=[]};l(),(n=u.COMSCORE)?(n.purge=l,n.beacon=m):COMSCORE={purge:l,beacon:m}}();